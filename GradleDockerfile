FROM openjdk:11

ARG WORKING_PATH=/home/gradle
ARG BUILD_DIR=${WORKING_PATH}/build
ARG GRADLE_CACHE=${WORKING_PATH}/.gradle

WORKDIR ${WORKING_PATH}

ADD ./ ./

ENV GRADLE_USER_HOME ${GRADLE_CACHE}

RUN rm -rf ${BUILD_DIR}

RUN ./gradlew --quiet --no-daemon build clean jar --build-cache

RUN chmod -R +rw ${WORKING_PATH}

ENTRYPOINT ["./gradlew", "--quiet", "--no-daemon"]
CMD ["tasks"]
